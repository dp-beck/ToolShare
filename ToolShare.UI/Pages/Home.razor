@page "/"
@using ToolShare.UI.Identity
@using Microsoft.AspNetCore.Components.QuickGrid

@inject IAccountManagement Acct

<PageTitle>Tool Share - Home</PageTitle>

<AuthorizeView Roles="NoPodUser" Context="Auth">
    <h1>Welcome to Tool Share!</h1>
    <p>You have not been added to a pod yet. See the pods that have been created so far below.
        Send the manager an email requesting to be added to their pod! Alternatively, go ahead
        and fill out the Create Pod form below to start your own pod!
    </p>

    <h2>Pods</h2>

        @if (Pods == null)
        {
            <p><em>Loading...</em></p>
        } else
        {
            <table>
            <thead>
                <tr>
                    <th>Pod Name</th>
                    <th>Pod Manager</th>
                    <th>Contact Email</th>
                </tr>
            </thead>
            <tbody>
            
            @foreach (var pod in Pods)
            {
                <tr>
                    <td>@pod.Name</td>
                    <td>@pod.PodManagerName</td>
                    <td>@pod.PodManagerEmail</td>
                </tr>
            }
                </tbody>
            </table>
        }
    <h2>Start a new pod!</h2>

    @if(success)
    {
        <div class=@StatusClass>@Message</div>
    }
    else
    {
        <EditForm Model="@podDTO"
            OnValidSubmit="HandleValidSubmit"
            OnInvalidSubmit="HandleInvalidSubmit">
        
            <label for="Name">Pod Name:</label>
            <InputText id="Name"
                @bind-Value="@podDTO.Name"
                placeholder="Enter Pod Name">
            </InputText>

            <button type="submit">Submit</button>

        </EditForm>
        @if(error) {
            <div class=@StatusClass>@Message</div>
        }
    }

</AuthorizeView>

<AuthorizeView Roles="User">
    <div>
        <a href="">All Tools</a>
        <a href="">Available Tools</a>
        <a href="">Your Tools</a>
    </div>

    <p>
        <input type="search" @bind="nameFilter" @bind:event="oninput" />
    </p>

    <QuickGrid class="table" Items="filteredTools" Pagination="pagination" >
        <PropertyColumn Property="tool => tool.Name" Sortable="true" />
        <PropertyColumn Property="tool => tool.Description" />
        <PropertyColumn Property="tool => tool.BorrowingPeriodInDays" />
    </QuickGrid>
    <Paginator State="pagination" />
</AuthorizeView>